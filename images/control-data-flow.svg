<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 700" style="font-family: Arial, sans-serif;">
  <defs>
    <marker id="arrowhead-blue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#4A90D9" />
    </marker>
    <marker id="arrowhead-green" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#5CB85C" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="600" y="35" text-anchor="middle" font-size="26" font-weight="bold" fill="#333">Control Plane vs Data Plane Data Flow</text>

  <!-- Control Plane Section (Left) -->
  <rect x="20" y="70" width="560" height="520" rx="10" fill="#E8F4FD" stroke="#4A90D9" stroke-width="3"/>
  <text x="300" y="105" text-anchor="middle" font-size="22" font-weight="bold" fill="#4A90D9">Control Plane</text>
  <text x="300" y="135" text-anchor="middle" font-size="14" fill="#333" font-style="italic">Small, infrequent data</text>

  <!-- cvlan-api box -->
  <rect x="210" y="170" width="180" height="80" rx="8" fill="#4A90D9" stroke="#333" stroke-width="2"/>
  <text x="300" y="205" text-anchor="middle" font-size="16" font-weight="bold" fill="#fff">cvlan-api</text>
  <text x="300" y="228" text-anchor="middle" font-size="12" fill="#fff">(Control Plane Server)</text>

  <!-- vrouterd box -->
  <rect x="80" y="340" width="140" height="70" rx="8" fill="#5CB85C" stroke="#333" stroke-width="2"/>
  <text x="150" y="372" text-anchor="middle" font-size="15" font-weight="bold" fill="#fff">vrouterd</text>
  <text x="150" y="392" text-anchor="middle" font-size="11" fill="#fff">(Gateway)</text>

  <!-- cvlan-ctrl box -->
  <rect x="380" y="340" width="140" height="70" rx="8" fill="#F0AD4E" stroke="#333" stroke-width="2"/>
  <text x="450" y="372" text-anchor="middle" font-size="15" font-weight="bold" fill="#fff">cvlan-ctrl</text>
  <text x="450" y="392" text-anchor="middle" font-size="11" fill="#fff">(Client Daemon)</text>

  <!-- Arrows between control plane components -->
  <line x1="220" y1="250" x2="180" y2="340" stroke="#4A90D9" stroke-width="3" marker-end="url(#arrowhead-blue)"/>
  <line x1="180" y1="320" x2="240" y2="250" stroke="#4A90D9" stroke-width="3" marker-end="url(#arrowhead-blue)"/>

  <line x1="380" y1="250" x2="430" y2="340" stroke="#4A90D9" stroke-width="3" marker-end="url(#arrowhead-blue)"/>
  <line x1="470" y1="340" x2="360" y2="250" stroke="#4A90D9" stroke-width="3" marker-end="url(#arrowhead-blue)"/>

  <!-- Data types -->
  <rect x="60" y="450" width="480" height="110" rx="6" fill="#fff" stroke="#4A90D9" stroke-width="2"/>
  <text x="300" y="475" text-anchor="middle" font-size="14" font-weight="bold" fill="#333">Data Types:</text>
  <text x="80" y="500" font-size="12" fill="#333">• Configuration (join tokens, settings)</text>
  <text x="80" y="520" font-size="12" fill="#333">• Peer lists and IP assignments</text>
  <text x="80" y="540" font-size="12" fill="#333">• mTLS certificates and CA chains</text>
  <text x="300" y="500" font-size="12" fill="#333">• Security policies</text>
  <text x="300" y="520" font-size="12" fill="#333">• DERP relay maps</text>
  <text x="300" y="540" font-size="12" fill="#333">• Audit events</text>

  <!-- Protocol info -->
  <text x="300" y="580" text-anchor="middle" font-size="13" font-weight="bold" fill="#4A90D9">HTTPS/mTLS • KB-sized payloads • Every 5-30 seconds</text>

  <!-- Data Plane Section (Right) -->
  <rect x="620" y="70" width="560" height="520" rx="10" fill="#E8F9E8" stroke="#5CB85C" stroke-width="3"/>
  <text x="900" y="105" text-anchor="middle" font-size="22" font-weight="bold" fill="#5CB85C">Data Plane</text>
  <text x="900" y="135" text-anchor="middle" font-size="14" fill="#333" font-style="italic">Bulk, continuous data</text>

  <!-- Node 1 -->
  <ellipse cx="750" cy="220" rx="70" ry="70" fill="#F0AD4E" stroke="#333" stroke-width="2"/>
  <text x="750" y="220" text-anchor="middle" font-size="14" font-weight="bold" fill="#fff">Node 1</text>
  <text x="750" y="238" text-anchor="middle" font-size="11" fill="#fff">(Client)</text>

  <!-- Node 2 -->
  <ellipse cx="1050" cy="220" rx="70" ry="70" fill="#F0AD4E" stroke="#333" stroke-width="2"/>
  <text x="1050" y="220" text-anchor="middle" font-size="14" font-weight="bold" fill="#fff">Node 2</text>
  <text x="1050" y="238" text-anchor="middle" font-size="11" fill="#fff">(Client)</text>

  <!-- VRouter in data plane -->
  <ellipse cx="900" cy="380" rx="80" ry="70" fill="#5CB85C" stroke="#333" stroke-width="2"/>
  <text x="900" y="375" text-anchor="middle" font-size="14" font-weight="bold" fill="#fff">VRouter</text>
  <text x="900" y="393" text-anchor="middle" font-size="11" fill="#fff">(Gateway)</text>

  <!-- Node 3 -->
  <ellipse cx="750" cy="500" rx="70" ry="70" fill="#F0AD4E" stroke="#333" stroke-width="2"/>
  <text x="750" y="500" text-anchor="middle" font-size="14" font-weight="bold" fill="#fff">Node 3</text>
  <text x="750" y="518" text-anchor="middle" font-size="11" fill="#fff">(Client)</text>

  <!-- Data plane traffic arrows -->
  <line x1="820" y1="220" x2="980" y2="220" stroke="#5CB85C" stroke-width="4" marker-end="url(#arrowhead-green)"/>
  <line x1="1030" y1="240" x2="870" y2="240" stroke="#5CB85C" stroke-width="4" marker-end="url(#arrowhead-green)"/>

  <line x1="820" y1="260" x2="860" y2="330" stroke="#5CB85C" stroke-width="4" marker-end="url(#arrowhead-green)"/>
  <line x1="840" y1="340" x2="800" y2="270" stroke="#5CB85C" stroke-width="4" marker-end="url(#arrowhead-green)"/>

  <line x1="960" y1="330" x2="1000" y2="260" stroke="#5CB85C" stroke-width="4" marker-end="url(#arrowhead-green)"/>
  <line x1="980" y1="250" x2="940" y2="320" stroke="#5CB85C" stroke-width="4" marker-end="url(#arrowhead-green)"/>

  <line x1="780" y1="440" x2="850" y2="410" stroke="#5CB85C" stroke-width="4" marker-end="url(#arrowhead-green)"/>
  <line x1="870" y1="430" x2="800" y2="460" stroke="#5CB85C" stroke-width="4" marker-end="url(#arrowhead-green)"/>

  <!-- Packet label -->
  <text x="900" y="175" text-anchor="middle" font-size="11" font-weight="bold" fill="#5CB85C">Encrypted Packets</text>

  <!-- Protocol info -->
  <text x="900" y="580" text-anchor="middle" font-size="13" font-weight="bold" fill="#5CB85C">UDP • WireGuard/IPsec • GB/s throughput • Continuous</text>

  <!-- Key insight box -->
  <rect x="100" y="620" width="1000" height="60" rx="8" fill="#FFF9E6" stroke="#F0AD4E" stroke-width="3"/>
  <text x="600" y="645" text-anchor="middle" font-size="15" font-weight="bold" fill="#333">Key Insight:</text>
  <text x="600" y="665" text-anchor="middle" font-size="14" fill="#333">Control plane can go offline temporarily — nodes cache state and keep forwarding packets</text>
</svg>