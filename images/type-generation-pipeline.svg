<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 780 420" font-family="Arial, Helvetica, sans-serif">
  <text x="390" y="28" text-anchor="middle" font-size="18" font-weight="bold" fill="#333">Type Generation Pipeline</text>
  <text x="390" y="46" text-anchor="middle" font-size="11" fill="#888">Single source of truth: Protocol Buffers → Rust + TypeScript</text>

  <!-- Source: Proto files -->
  <rect x="30" y="80" width="160" height="120" rx="8" fill="#9B59B6" stroke="#8E44AD" stroke-width="1.5"/>
  <text x="110" y="105" text-anchor="middle" font-size="13" font-weight="bold" fill="white">Proto Sources</text>
  <text x="110" y="120" text-anchor="middle" font-size="10" fill="#D4B8E8">protodefs/cloudvlan/v1/</text>

  <rect x="45" y="130" width="130" height="20" rx="3" fill="white" fill-opacity="0.2"/>
  <text x="110" y="144" text-anchor="middle" font-size="9" fill="white">common.proto</text>
  <rect x="45" y="153" width="130" height="20" rx="3" fill="white" fill-opacity="0.2"/>
  <text x="110" y="167" text-anchor="middle" font-size="9" fill="white">vrouter.proto</text>
  <rect x="45" y="176" width="130" height="20" rx="3" fill="white" fill-opacity="0.2"/>
  <text x="110" y="190" text-anchor="middle" font-size="9" fill="white">region.proto + more...</text>

  <!-- Arrow to buf -->
  <line x1="190" y1="140" x2="250" y2="140" stroke="#9B59B6" stroke-width="2" marker-end="url(#arr-p)"/>

  <!-- buf generate -->
  <rect x="250" y="100" width="140" height="80" rx="8" fill="#333" stroke="#555" stroke-width="1.5"/>
  <text x="320" y="128" text-anchor="middle" font-size="14" font-weight="bold" fill="white">buf generate</text>
  <text x="320" y="148" text-anchor="middle" font-size="10" fill="#AAA">v1.28.1</text>
  <rect x="265" y="155" width="110" height="18" rx="3" fill="white" fill-opacity="0.15"/>
  <text x="320" y="168" text-anchor="middle" font-size="9" fill="#CCC">buf.gen.yaml config</text>

  <!-- Split arrows -->
  <!-- Rust path (top) -->
  <line x1="390" y1="120" x2="480" y2="85" stroke="#4A90D9" stroke-width="2" marker-end="url(#arr-b)"/>
  <text x="430" y="90" font-size="9" fill="#4A90D9">protoc-gen-prost</text>

  <!-- TypeScript path (bottom) -->
  <line x1="390" y1="160" x2="480" y2="200" stroke="#5BC0DE" stroke-width="2" marker-end="url(#arr-lb)"/>
  <text x="430" y="195" font-size="9" fill="#5BC0DE">protoc-gen-ts_proto</text>

  <!-- Rust output -->
  <rect x="480" y="55" width="260" height="80" rx="8" fill="#4A90D9" stroke="#3A7BC8" stroke-width="1.5"/>
  <text x="610" y="78" text-anchor="middle" font-size="13" font-weight="bold" fill="white">Rust Types</text>
  <text x="610" y="93" text-anchor="middle" font-size="10" fill="#D4E6F9">api/src/gen/cloudvlan/v1/</text>
  <rect x="495" y="100" width="110" height="18" rx="3" fill="white" fill-opacity="0.2"/>
  <text x="550" y="113" text-anchor="middle" font-size="9" fill="white">prost structs</text>
  <rect x="615" y="100" width="110" height="18" rx="3" fill="white" fill-opacity="0.2"/>
  <text x="670" y="113" text-anchor="middle" font-size="9" fill="white">serde derives</text>

  <!-- TypeScript output -->
  <rect x="480" y="170" width="260" height="80" rx="8" fill="#5BC0DE" stroke="#46B0CE" stroke-width="1.5"/>
  <text x="610" y="193" text-anchor="middle" font-size="13" font-weight="bold" fill="white">TypeScript Types</text>
  <text x="610" y="208" text-anchor="middle" font-size="10" fill="white">protodefs/gen/ts/cloudvlan/v1/</text>
  <rect x="495" y="215" width="110" height="18" rx="3" fill="white" fill-opacity="0.2"/>
  <text x="550" y="228" text-anchor="middle" font-size="9" fill="white">interfaces</text>
  <rect x="615" y="215" width="110" height="18" rx="3" fill="white" fill-opacity="0.2"/>
  <text x="670" y="228" text-anchor="middle" font-size="9" fill="white">encode/decode</text>

  <!-- Consumers -->
  <!-- Arrow: Rust → cvlan-api -->
  <line x1="610" y1="135" x2="610" y2="290" stroke="#4A90D9" stroke-width="1.5" stroke-dasharray="5,3"/>
  <text x="620" y="275" font-size="9" fill="#4A90D9">compile-time</text>

  <!-- Arrow: TS → sync to UI -->
  <line x1="610" y1="250" x2="610" y2="290" stroke="#5BC0DE" stroke-width="1.5" stroke-dasharray="5,3"/>

  <!-- Consumer boxes -->
  <rect x="30" y="290" width="710" height="80" rx="8" fill="#F8F8F8" stroke="#DDD" stroke-width="1.5"/>
  <text x="390" y="312" text-anchor="middle" font-size="12" font-weight="bold" fill="#555">Consumers</text>

  <rect x="50" y="320" width="140" height="35" rx="6" fill="#4A90D9"/>
  <text x="120" y="342" text-anchor="middle" font-size="11" font-weight="bold" fill="white">cvlan-api</text>

  <rect x="210" y="320" width="140" height="35" rx="6" fill="#5CB85C"/>
  <text x="280" y="342" text-anchor="middle" font-size="11" font-weight="bold" fill="white">vrouterd</text>

  <rect x="370" y="320" width="140" height="35" rx="6" fill="#F0AD4E"/>
  <text x="440" y="342" text-anchor="middle" font-size="11" font-weight="bold" fill="white">cvlan-ctrl</text>

  <rect x="530" y="320" width="140" height="35" rx="6" fill="#5BC0DE"/>
  <text x="600" y="342" text-anchor="middle" font-size="11" font-weight="bold" fill="white">Management UI</text>

  <!-- Design principles -->
  <rect x="30" y="385" width="710" height="25" rx="4" fill="#FFF9E6" stroke="#F0AD4E" stroke-width="1"/>
  <text x="390" y="402" text-anchor="middle" font-size="10" fill="#333">Package: cloudvlan.v1 | Enums start at 0 (UNSPECIFIED) | UUIDs as strings | Timestamps: google.protobuf.Timestamp</text>

  <defs>
    <marker id="arr-p" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto"><polygon points="0 0,8 3,0 6" fill="#9B59B6"/></marker>
    <marker id="arr-b" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto"><polygon points="0 0,8 3,0 6" fill="#4A90D9"/></marker>
    <marker id="arr-lb" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto"><polygon points="0 0,8 3,0 6" fill="#5BC0DE"/></marker>
  </defs>
</svg>
